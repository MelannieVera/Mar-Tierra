<!DOCTYPE html> 
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Mariscos del Mar</title>
<style>
html, body { margin:0; padding:0; width:100%; height:100%; font-family: Arial, sans-serif; background:#f2f2f2; }
body { display:flex; justify-content:center; align-items:flex-start; min-height:100vh; }
.container, .realizar-pedido-container, .table-container { background:white; padding:30px 40px; border-radius:15px; box-shadow:0 5px 20px rgba(0,0,0,0.2); width:95%; max-width:1200px; margin:20px auto; text-align:center; }
img.logo { width:100px; height:100px; border-radius:50%; margin-bottom:15px; object-fit:cover; border:3px solid #0077b6; transition: transform 0.3s ease-in-out; }
img.logo:hover { transform: scale(1.2); }
h2 { margin-bottom:25px; color:#0077b6; padding:5px 0; }
input, select, textarea, button { width:100%; padding:12px; margin-bottom:15px; border-radius:8px; box-sizing:border-box; font-size:1rem; }
button { background:#0077b6; color:white; border:none; cursor:pointer; font-weight:bold; transition: background 0.3s, transform 0.2s; }
button:hover { background:#0096c7; transform: scale(1.05); }
.table-wrapper { width:100%; overflow-x:auto; }
table { width:100%; border-collapse:collapse; table-layout:auto; }
th, td { border-bottom:1px solid #ccc; padding:10px; text-align:center; word-wrap:break-word; }
th { color:#0077b6; }
.action-btn { padding:8px 12px; border-radius:6px; background:#0077b6; color:white; cursor:pointer; font-size:0.9em; margin:2px; transition: all 0.2s; }
.action-btn:hover { background:#0096c7; transform: scale(1.05); }
.platillo-item { display:flex; justify-content:space-between; align-items:center; border:1px solid #ccc; padding:12px; margin-bottom:12px; border-radius:10px; flex-wrap:wrap; }
.platillo-info { flex:2; min-width:200px; text-align:left; }
.platillo-actions { display:flex; align-items:center; gap:10px; }
.platillo-actions input { width:60px; padding:6px; }
.category-title { text-align:left; font-weight:bold; margin-top:20px; color:#0077b6; font-size:1.2rem; border-bottom:1px dashed #0077b6; padding-bottom:5px; }
.tabs { display:flex; justify-content:center; margin-bottom:20px; border-bottom:2px solid #0077b6; }
.tab-btn { flex:1; padding:12px; background:#e0f0f7; border:none; cursor:pointer; font-weight:bold; color:#0077b6; transition: background 0.3s, transform 0.2s; }
.tab-btn.active { background:#0077b6; color:white; transform: scale(1.02); }
.tab-content { display:none; }
.tab-content.active { display:block; }
@media (max-width:1000px){ .container, .realizar-pedido-container { padding:20px;} table { font-size:0.95rem; } }
@media (max-width:700px){ body{padding:12px;} img.logo{width:86px;height:86px;} h2{font-size:1.2rem;} table{font-size:0.85rem;} }
@media (max-width:480px){ img.logo{width:72px;height:72px;} h2{font-size:1.05rem;} table{font-size:0.75rem;} .platillo-item{flex-direction:column;align-items:flex-start;} .platillo-actions{flex-direction:row;justify-content:space-between;width:100%;} }
</style>
</head>
<body>
<div id="app"></div>
<script>
const app=document.getElementById('app');
const usuarios=[{id:'admin',password:'admin123',tipo:'Administrador'},{id:'emple1',password:'123',tipo:'Empleado'}];
let personal=[]; 
let platillos=[]; 
let pedidos=[]; 
let empleadoActual=null;

// ---------- LOGIN ----------
function renderLogin(){
    app.innerHTML=`<div class="container">
        <img class="logo" src="img/logo.png">
        <h2>Iniciar Sesión</h2>
        <input type="text" id="userId" placeholder="ID">
        <input type="password" id="userPassword" placeholder="Contraseña">
        <button onclick="login()">Ingresar</button>
    </div>`;
}
function login(){
    const id=document.getElementById('userId').value.trim();
    const password=document.getElementById('userPassword').value.trim();
    const user=usuarios.find(u=>u.id===id && u.password===password);
    if(user){empleadoActual=(user.tipo==='Empleado')?user.id:null; user.tipo==='Administrador'?renderAdminMenu():renderEmpleadoMenu();}
    else alert("Usuario o contraseña incorrecta");
}

// ---------- MENUS ----------
function renderAdminMenu(){
    app.innerHTML=`<div class="container">
        <img class="logo" src="img/logo.png">
        <h2>Menú Administrador</h2>
        <button onclick="renderRegistrarPersonal()">Registrar Personal</button>
        <button onclick="renderListaPersonal()">Lista de Personal</button>
        <button onclick="renderRegistrarPlatillo()">Registrar Platillo</button>
        <button onclick="renderListaPlatillos()">Lista de Platillos</button>
        <button onclick="renderRealizarPedido()">Realizar Pedido</button>
        <button onclick="renderListaPedidos()">Pedidos Realizados</button>
        <button onclick="renderReporteVentas()">Reporte de Ventas</button>
        <button onclick="renderLogin()">Cerrar Sesión</button>
    </div>`;
}
function renderEmpleadoMenu(){
    app.innerHTML=`<div class="container">
        <img class="logo" src="img/logo.png">
        <h2>Menú Empleado</h2>
        <button onclick="renderRealizarPedido()">Realizar Pedido</button>
        <button onclick="renderListaPedidos()">Pedidos Realizados</button>
        <button onclick="renderLogin()">Cerrar Sesión</button>
    </div>`;
}

// ---------- PERSONAL ----------
function renderRegistrarPersonal(){
    app.innerHTML=`<div class="container">
        <img class="logo" src="img/logo.png">
        <h2>Registrar Personal</h2>
        <input type="text" id="personal-id" placeholder="ID">
        <input type="password" id="personal-password" placeholder="Contraseña">
        <select id="personal-tipo">
            <option value="Empleado">Empleado</option>
            <option value="Administrador">Administrador</option>
        </select>
        <input type="text" id="personal-nombre" placeholder="Nombre">
        <input type="text" id="personal-celular" placeholder="Celular">
        <input type="email" id="personal-mail" placeholder="Email">
        <input type="text" id="personal-direccion" placeholder="Dirección">
        <button onclick="agregarPersonal()">Agregar</button>
        <button onclick="renderAdminMenu()">Volver</button>
    </div>`;
}
function agregarPersonal(){
    const id=document.getElementById('personal-id').value.trim();
    const password=document.getElementById('personal-password').value.trim();
    const tipo=document.getElementById('personal-tipo').value;
    const nombre=document.getElementById('personal-nombre').value.trim();
    const celular=document.getElementById('personal-celular').value.trim();
    const mail=document.getElementById('personal-mail').value.trim();
    const direccion=document.getElementById('personal-direccion').value.trim();
    if(!id||!password||!nombre){alert("ID, contraseña y nombre obligatorios."); return;}
    personal.push({id,password,tipo,nombre,celular,mail,direccion});
    alert("Personal agregado."); renderRegistrarPersonal();
}

// ---------- LISTA PERSONAL + BUSCADOR ----------
function renderListaPersonal(){
    let filas=personal.map((p,i)=>`<tr>
        <td>${p.id}</td><td>${p.tipo}</td><td>${p.nombre}</td>
        <td>${p.celular}</td><td>${p.mail}</td><td>${p.direccion}</td>
        <td>
            <button class="action-btn" onclick="editarPersonal(${i})">Editar</button>
            <button class="action-btn" onclick="eliminarPersonal(${i})">Eliminar</button>
        </td>
    </tr>`).join('');
    app.innerHTML=`<div class="table-container">
        <img class="logo" src="img/logo.png">
        <h2>Lista de Personal</h2>
        <input type="text" id="buscarPersonal" placeholder="Buscar por ID o nombre" oninput="filtrarPersonal()">
        <div class="table-wrapper">
          <table id="tablaPersonal">
            <thead><tr><th>ID</th><th>Tipo</th><th>Nombre</th><th>Celular</th><th>Email</th><th>Dirección</th><th>Acciones</th></tr></thead>
            <tbody>${filas}</tbody>
          </table>
        </div>
        <button onclick="renderRegistrarPersonal()">Agregar Nuevo</button>
        <button onclick="renderAdminMenu()">Volver</button>
    </div>`;
}
function filtrarPersonal(){
    const filtro=document.getElementById('buscarPersonal').value.toLowerCase();
    const filas=document.querySelectorAll('#tablaPersonal tbody tr');
    filas.forEach(f=>{
        const texto=f.innerText.toLowerCase();
        f.style.display=texto.includes(filtro)?'':'none';
    });
}
function editarPersonal(i){
    const p=personal[i];
    app.innerHTML=`<div class="container">
        <img class="logo" src="img/logo.png">
        <h2>Editar Personal</h2>
        <input type="text" id="edit-id" value="${p.id}">
        <input type="password" id="edit-password" value="${p.password}">
        <select id="edit-tipo">
            <option value="Empleado" ${p.tipo==='Empleado'?'selected':''}>Empleado</option>
            <option value="Administrador" ${p.tipo==='Administrador'?'selected':''}>Administrador</option>
        </select>
        <input type="text" id="edit-nombre" value="${p.nombre}">
        <input type="text" id="edit-celular" value="${p.celular}">
        <input type="email" id="edit-mail" value="${p.mail}">
        <input type="text" id="edit-direccion" value="${p.direccion}">
        <button onclick="guardarEdicionPersonal(${i})">Guardar</button>
        <button onclick="renderListaPersonal()">Cancelar</button>
    </div>`;
}
function guardarEdicionPersonal(i){
    const id=document.getElementById('edit-id').value.trim();
    const password=document.getElementById('edit-password').value.trim();
    const tipo=document.getElementById('edit-tipo').value;
    const nombre=document.getElementById('edit-nombre').value.trim();
    const celular=document.getElementById('edit-celular').value.trim();
    const mail=document.getElementById('edit-mail').value.trim();
    const direccion=document.getElementById('edit-direccion').value.trim();
    if(!id||!password||!nombre){alert("ID, contraseña y nombre obligatorios."); return;}
    personal[i]={id,password,tipo,nombre,celular,mail,direccion};
    alert("Empleado actualizado."); renderListaPersonal();
}
function eliminarPersonal(i){if(confirm("¿Desea eliminar este registro?")){personal.splice(i,1);renderListaPersonal();}}

// ---------- PLATILLOS + BUSCADOR ----------
function renderRegistrarPlatillo(){
    app.innerHTML=`<div class="container">
        <img class="logo" src="img/logo.png">
        <h2>Registrar Platillo</h2>
        <input type="text" id="platillo-nombre" placeholder="Nombre">
        <input type="number" id="platillo-precio" placeholder="Precio">
        <textarea id="platillo-descripcion" placeholder="Descripción"></textarea>
        <select id="platillo-categoria">
            <option value="Bebidas">Bebidas</option>
            <option value="Barra Fría">Barra Fría</option>
            <option value="Barra Caliente">Barra Caliente</option>
        </select>
        <button onclick="agregarPlatillo()">Agregar</button>
        <button onclick="renderAdminMenu()">Volver</button>
    </div>`;
}
function agregarPlatillo(){
    const nombre=document.getElementById('platillo-nombre').value.trim();
    const precio=parseFloat(document.getElementById('platillo-precio').value);
    const descripcion=document.getElementById('platillo-descripcion').value.trim();
    const categoria=document.getElementById('platillo-categoria').value;
    if(!nombre||isNaN(precio)){alert("Nombre y precio obligatorios."); return;}
    platillos.push({nombre,precio,descripcion,categoria});
    alert("Platillo agregado"); renderRegistrarPlatillo();
}
function renderListaPlatillos(){
    let filas=platillos.length>0 ? platillos.map((p,i)=>`<tr>
        <td>${p.nombre}</td><td>${p.precio}</td><td>${p.descripcion}</td><td>${p.categoria}</td>
        <td>
            <button class="action-btn" onclick="editarPlatillo(${i})">Editar</button>
            <button class="action-btn" onclick="eliminarPlatillo(${i})">Eliminar</button>
        </td>
    </tr>`).join('') : `<tr><td colspan="5">No hay platillos registrados</td></tr>`;
    app.innerHTML=`<div class="table-container">
        <img class="logo" src="img/logo.png">
        <h2>Lista de Platillos</h2>
        <input type="text" id="buscarPlatillo" placeholder="Buscar por nombre o categoría" oninput="filtrarPlatillos()">
        <div class="table-wrapper">
          <table id="tablaPlatillos"><thead><tr><th>Nombre</th><th>Precio</th><th>Descripción</th><th>Categoría</th><th>Acciones</th></tr></thead>
          <tbody>${filas}</tbody></table>
        </div>
        <button onclick="renderRegistrarPlatillo()">Agregar Nuevo</button>
        <button onclick="${empleadoActual?'renderEmpleadoMenu()':'renderAdminMenu()'}">Volver</button>
    </div>`;
}
function filtrarPlatillos(){
    const filtro=document.getElementById('buscarPlatillo').value.toLowerCase();
    const filas=document.querySelectorAll('#tablaPlatillos tbody tr');
    filas.forEach(f=>{
        const texto=f.innerText.toLowerCase();
        f.style.display=texto.includes(filtro)?'':'none';
    });
}
<!-- Coloca esto dentro del mismo <script> después de tus funciones de platillos -->

// ---------- EDITAR / ELIMINAR PLATILLO ----------
function editarPlatillo(i){
    const p = platillos[i];
    app.innerHTML=`<div class="container">
        <img class="logo" src="img/logo.png">
        <h2>Editar Platillo</h2>
        <input type="text" id="edit-nombre" value="${p.nombre}" placeholder="Nombre">
        <input type="number" id="edit-precio" value="${p.precio}" placeholder="Precio">
        <textarea id="edit-descripcion" placeholder="Descripción">${p.descripcion}</textarea>
        <select id="edit-categoria">
            <option value="Bebidas" ${p.categoria==='Bebidas'?'selected':''}>Bebidas</option>
            <option value="Barra Fría" ${p.categoria==='Barra Fría'?'selected':''}>Barra Fría</option>
            <option value="Barra Caliente" ${p.categoria==='Barra Caliente'?'selected':''}>Barra Caliente</option>
        </select>
        <button onclick="guardarEdicionPlatillo(${i})">Guardar</button>
        <button onclick="renderListaPlatillos()">Cancelar</button>
    </div>`;
}

function guardarEdicionPlatillo(i){
    const nombre = document.getElementById('edit-nombre').value.trim();
    const precio = parseFloat(document.getElementById('edit-precio').value);
    const descripcion = document.getElementById('edit-descripcion').value.trim();
    const categoria = document.getElementById('edit-categoria').value;
    if(!nombre||isNaN(precio)){ alert("Nombre y precio obligatorios."); return; }
    platillos[i] = {nombre, precio, descripcion, categoria};
    alert("Platillo actualizado.");
    renderListaPlatillos();
}

function eliminarPlatillo(i){
    if(confirm("¿Desea eliminar este platillo?")){
        platillos.splice(i,1);
        renderListaPlatillos();
    }
}


// ---------- PEDIDOS MULTI-CATEGORÍA ----------
function renderRealizarPedido(){
    if(platillos.length===0){alert("No hay platillos registrados."); empleadoActual?renderEmpleadoMenu():renderAdminMenu(); return;}
    const categorias=['Bebidas','Barra Fría','Barra Caliente'];
    let contenidoTabs = categorias.map(cat=>{
        const items=platillos.filter(p=>p.categoria===cat);
        if(items.length===0) return `<div class='tab-content' id='tab-${cat.replace(/\s/g,"")}'>No hay platillos en esta categoría</div>`;
        let html = items.map(p=>{
            const globalIndex = platillos.indexOf(p);
            return `<div class="platillo-item">
                <div class="platillo-info"><strong>${p.nombre}</strong><br>${p.descripcion}<br>$${p.precio}</div>
                <div class="platillo-actions">
                    <input type="number" id="cantidad-${globalIndex}" min="0" value="0" oninput="actualizarResumen()">
                </div>
            </div>`;
        }).join('');
        return `<div class='tab-content' id='tab-${cat.replace(/\s/g,"")}'>${html}</div>`;
    }).join('');

    app.innerHTML=`<div class="realizar-pedido-container" style="display:flex; flex-wrap:wrap; gap:20px;">
        <div style="flex:2; min-width:300px;">
            <img class="logo" src="img/logo.png">
            <h2>Realizar Pedido</h2>
            <input type="text" id="mesa-num" placeholder="Número de Mesa">
            <div class="tabs">
                <button class="tab-btn active" onclick="mostrarTab('Bebidas', event)">Bebidas</button>
                <button class="tab-btn" onclick="mostrarTab('Barra Fría', event)">Barra Fría</button>
                <button class="tab-btn" onclick="mostrarTab('Barra Caliente', event)">Barra Caliente</button>
            </div>
            ${contenidoTabs}
            <button onclick="${empleadoActual?'renderEmpleadoMenu()':'renderAdminMenu()'}">Volver</button>
        </div>
        <div style="flex:1; min-width:250px; border:1px solid #ccc; border-radius:10px; padding:15px; height:min-content;">
            <h3>Resumen del Pedido</h3>
            <div id="resumen-pedido">No hay platillos agregados</div>
            <h4 id="total-pedido">Total: $0</h4>
            <button onclick="confirmarPedido()">Confirmar Pedido</button>
        </div>
    </div>`;

    mostrarTab('Bebidas');
    actualizarResumen();
}
function mostrarTab(nombre,event){
    document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
    if(event) event.currentTarget.classList.add('active');
    document.querySelectorAll('.tab-content').forEach(c=>c.classList.remove('active'));
    document.getElementById(`tab-${nombre.replace(/\s/g,"")}`)?.classList.add('active');
}
function actualizarResumen(){
    let resumenDiv=document.getElementById('resumen-pedido');
    let totalDiv=document.getElementById('total-pedido');
    let itemsSeleccionados=[]; let total=0;
    platillos.forEach((p,i)=>{
        const cantidad=parseInt(document.getElementById(`cantidad-${i}`)?.value||0);
        if(cantidad>0){
            itemsSeleccionados.push(`${p.nombre} x${cantidad} ($${p.precio*cantidad})`);
            total += p.precio*cantidad;
        }
    });
    resumenDiv.innerHTML = itemsSeleccionados.length>0 ? itemsSeleccionados.join('<br>') : 'No hay platillos agregados';
    totalDiv.innerHTML = `Total: $${total}`;
}
function confirmarPedido(){
    const mesa=document.getElementById('mesa-num').value.trim();
    if(!mesa){alert("Ingrese número de mesa."); return;}
    let pedidoItems=[];
    let total=0;
    platillos.forEach((p,i)=>{
        const cantidad=parseInt(document.getElementById(`cantidad-${i}`)?.value||0);
        if(cantidad>0){ 
            pedidoItems.push({nombre:p.nombre,cantidad,precio:p.precio});
            total += p.precio*cantidad;
        }
    });
    if(pedidoItems.length===0){alert("No hay platillos seleccionados."); return;}
    pedidos.push({mesa,items:pedidoItems,total,fecha:new Date().toLocaleString(),usuario:empleadoActual||'Administrador'});
    alert("Pedido confirmado.");
    renderRealizarPedido();
}

// ---------- LISTA DE PEDIDOS CON TOTAL ----------
function renderListaPedidos(){
    let filas=pedidos.length>0 ? pedidos.map((p,i)=>`<tr>
        <td>${p.mesa}</td>
        <td>${p.fecha}</td>
        <td>${p.usuario}</td>
        <td>${p.items.map(it=>`${it.nombre} x${it.cantidad}`).join(', ')}</td>
        <td>$${p.total}</td>
        <td>
            <button class="action-btn" onclick="editarPedido(${i})">Editar</button>
            <button class="action-btn" onclick="eliminarPedido(${i})">Eliminar</button>
        </td>
    </tr>`).join('') : `<tr><td colspan="6">No hay pedidos</td></tr>`;
    app.innerHTML=`<div class="table-container">
        <img class="logo" src="img/logo.png">
        <h2>Pedidos Realizados</h2>
        <div class="table-wrapper">
          <table><thead><tr><th>Mesa</th><th>Fecha</th><th>Usuario</th><th>Platillos</th><th>Total</th><th>Acciones</th></tr></thead>
          <tbody>${filas}</tbody></table>
        </div>
        <button onclick="${empleadoActual?'renderEmpleadoMenu()':'renderAdminMenu()'}">Volver</button>
    </div>`;
}

// ---------- EDITAR / ELIMINAR PEDIDO ----------
function editarPedido(i){
    const pedido = pedidos[i];
    app.innerHTML=`<div class="realizar-pedido-container" style="display:flex; flex-wrap:wrap; gap:20px;">
        <div style="flex:2; min-width:300px;">
            <img class="logo" src="img/logo.png">
            <h2>Editar Pedido</h2>
            <input type="text" id="mesa-num" placeholder="Número de Mesa" value="${pedido.mesa}">
            ${pedido.items.map((it,index)=>`
                <div class="platillo-item">
                    <div class="platillo-info"><strong>${it.nombre}</strong></div>
                    <div class="platillo-actions">
                        <input type="number" id="edit-cantidad-${index}" value="${it.cantidad}" min="0">
                    </div>
                </div>
            `).join('')}
            <button onclick="guardarEdicionPedido(${i})">Guardar</button>
            <button onclick="renderListaPedidos()">Cancelar</button>
        </div>
    </div>`;
}
function guardarEdicionPedido(i){
    const mesa = document.getElementById('mesa-num').value.trim();
    if(!mesa){alert("Ingrese número de mesa."); return;}
    const pedido = pedidos[i];
    pedido.mesa = mesa;
    let total=0;
    pedido.items.forEach((it,index)=>{
        const cantidad = parseInt(document.getElementById(`edit-cantidad-${index}`).value) || 0;
        it.cantidad = cantidad;
        total += it.cantidad*it.precio;
    });
    pedido.total=total;
    alert("Pedido actualizado.");
    renderListaPedidos();
}
function eliminarPedido(i){if(confirm("¿Desea eliminar este pedido?")){pedidos.splice(i,1); renderListaPedidos();}}

// ---------- REPORTE DE VENTAS ----------
function renderReporteVentas(){
    let filas=pedidos.length>0 ? pedidos.map((p,i)=>`<tr>
        <td>${p.fecha}</td>
        <td>$${p.items.reduce((a,b)=>a+b.precio*b.cantidad,0)}</td>
        <td>${p.items.map(it=>it.nombre).join(', ')}</td>
    </tr>`).join('') : `<tr><td colspan="3">No hay ventas</td></tr>`;
    app.innerHTML=`<div class="table-container">
        <img class="logo" src="img/logo.png">
        <h2>Reporte de Ventas</h2>
        <div class="table-wrapper">
          <table><thead><tr><th>Fecha</th><th>Total de Ventas</th><th>Platillos Vendidos</th></tr></thead>
          <tbody>${filas}</tbody></table>
        </div>
        <button onclick="renderAdminMenu()">Volver</button>
    </div>`;
}

// ---------- INICIO ----------
renderLogin();
</script>
</body>
</html>
